var CalendarRange={DAY:864e5,prepareDate:function(a){a=new Date(a);var b=a.getDay();return{date:a,weekday:0!==b&&6!==b,day:a.getDate(),month:a.getMonth(),year:a.getFullYear()}},getMonthlyRange:function(a,b){var c=a.getMonth(),d=new Date(a);d.setDate(1);var e=new Date(d);e.getDay()>0&&e.setDate(e.getDate()-e.getDay());var f=new Date(d);11===c?(f.setMonth(0),f.setYear(f.getFullYear()+1)):f.setMonth(c+1),f.setDate(f.getDate()-1);var g=new Date(f);g.setDate(g.getDate()+(6-f.getDay()));for(var h=new Date(e),i=[],j=[],k=b.getDataResponse(),l=0;g>=h;){var m=h.getDate(),n=h.getMonth()+1,o=h.getFullYear();i.push(this.prepareDate(h)),h.setDate(h.getDate()+1),j.push(k[l]||{displayDate:n+"/"+m+"/"+o,student:"Sally",time:"09:00",instrument:"oboe"}),l++}return{first:e,start:d,end:f,last:g,days:i,appointments:j}}};angular.module("lessonsApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"AppCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/day/:dayCode",{templateUrl:"views/day.html",controller:"DayCtrl",resolve:{dayDetails:["$rootScope","$route","dataService",function(a,b,c){var d=b.current.params.dayCode,e=c.getDataResponse();return e[d]}],dayCode:["$route",function(a){var b=a.current.params.dayCode;return b}]}}).otherwise({redirectTo:"/"})}]),angular.module("lessonsApp").factory("dataService",function(){var a=[];return{saveDataResponse:function(b){a=b},getDataResponse:function(){return a}}}).controller("AppCtrl",["$scope",function(a){var b=new Date,c=b.getFullYear(),d=b.getMonth();a.date={year:c,month:d},a.isCurrentMonth=function(b){return b.getMonth()==a.date.month},a.months="january,february,march,april,may,june,july,august,september,october,november,december".split(",");for(var e=[],f=c-20,g=f;c+20>=g;g++)e.push(g);a.years=e,a.$watchCollection("date",function(b){a.currentDate=new Date(b.year,b.month,1)})}]).directive("myCalendar",["dataService",function(a){return{terminal:!0,priority:1e3,transclude:"element",link:function(b,c,d,e,f){var g=b.$new(),h=angular.element("<div></div>");h.addClass("calendar-container"),c.after(h),b.$watch(d.myCalendar,function(c,d){if(c){var e=CalendarRange.getMonthlyRange(c,a),i=e.appointments;d.appointments=e.appointments,a.saveDataResponse(e.appointments),g.$destroy(),g=b.$new(),h.html(""),angular.forEach(e.days,function(a,b){var c=g.$new();c.day=a,c.dayKey=b,c.appointments=i[b],f(c,function(a){a.addClass("calendar-cell"),h.append(a)})})}})}}}]),angular.module("lessonsApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("lessonsApp").controller("DayCtrl",["$scope","dayDetails","dayCode","dataService",function(a,b,c,d){a.dayCode=c,a.dayDetails=b,a.submit=function(){var b=d.getDataResponse();b[a.dayCode]=a.dayDetails,d.saveDataResponse(b),window.navigate?window.navigate("#"):location.assign("#")},a.cancel=function(a){a.preventDefault(),window.navigate?window.navigate("#"):location.assign("#")}}]);